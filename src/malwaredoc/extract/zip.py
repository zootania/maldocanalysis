"""Extraction of data from zip files."""
from pathlib import Path
import subprocess
import zipfile
import logging

from malwaredoc.config import WIN_7Z_PATH


def unzip_file(path: Path, target_dir: Path) -> None:
    """
    Extract zip file into target directory.
    Args:
        path: :class:`Path` to file.
        target_dir: :class:`Path` to target directory.

    Returns: None

    """
    with zipfile.ZipFile(path.absolute(), "r") as zip_ref:
        zip_ref.extractall(target_dir.absolute())

def unzip_with_7z(file_path: str, extract_to: str) -> None:
    """Synchronously extract a file to a specified directory.

    Args:
        file_path: The path to the file to be extracted.
        extract_to: The directory where the file should be extracted.
    """
    cmd = [WIN_7Z_PATH, 'x', file_path, f'-o{extract_to}', '-y']
    process = subprocess.run(cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
    
    if process.returncode != 0:
        logging.error(f"Error extracting file {file_path}: {process.stderr}")
