"""Xlsx file processing methods."""
import logging
from pathlib import Path

import pandas as pd


def extract_text_xlsx(path: Path) -> str:
    data = ""
    
    try:
        xlsx = pd.ExcelFile(path)
        for sheet in xlsx.sheet_names:
            df = pd.read_excel(xlsx, sheet_name=sheet, dtype=str)
            if df.empty:
                continue
            df = df.fillna("")
            excel_non_empty = pd.read_excel(xlsx, sheet_name=sheet, dtype=str).fillna("")
            just_strings = [excel_non_empty[col].astype(str).str.cat(sep=' ', na_rep="").strip() for col in excel_non_empty.columns]
            all_strings = f"{' '.join([i.strip() for i in just_strings if i])} \n"
            data = f"{data} {all_strings}"
    except Exception:
        logging.error(f"Couldn't extract text from file using excel pipeline: {path}")
    return data
