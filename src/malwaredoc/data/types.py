from typing_extensions import Annotated

from pydantic import PlainSerializer, PlainValidator

from malwaredoc.extract.util import (
    convert_type_to_string,
    hex_bytes_validator,
    type_validator,
)
from filetype.types import Type

HexBytes = Annotated[
    bytes, PlainValidator(hex_bytes_validator), PlainSerializer(lambda v: v.hex())
]

FileType = Annotated[
    Type,
    PlainValidator(type_validator),
    PlainSerializer(lambda v: convert_type_to_string(v)),
]
