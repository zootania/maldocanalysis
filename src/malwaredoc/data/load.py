"""Methods to load data from files."""
from pathlib import Path

from malwaredoc.data.base import Base
from malwaredoc.data.data import (
    FileAnalysis,
    OfficeFileAnalysis,
    PdfFileAnalysis,
    RtfFileAnalysis,
    WordFileAnalysis,
    XlsxFileAnalysis,
    ZipFileAnalysis,
)
from malwaredoc.util.filesystem import load_model_from_file

# order matters for this list!
_RELEVANT_MODELS = [
    ZipFileAnalysis,
    RtfFileAnalysis,
    XlsxFileAnalysis,
    WordFileAnalysis,
    OfficeFileAnalysis,
    RtfFileAnalysis,
    PdfFileAnalysis,
    FileAnalysis,
]


def parse_correct_model_from_file(path: Path) -> Base:
    """
    Parse correct data model from file.
    Args:
        path: path to file.

    Returns:
        Correct Model type with parsed content.
    """
    for model in _RELEVANT_MODELS:
        try:
            return load_model_from_file(model, path)
        except Exception:
            continue
    raise ValueError(f"No model can be parsed from: {path}")
