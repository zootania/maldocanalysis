import os.path
from pathlib import Path
from typing import List

import pytest
from malwaredoc.extract.zip import unzip_file


@pytest.mark.parametrize(
    "zip_file, extracted_files",
    [(Path("tests/resources/zip/test.zip"), ["text.docx", "text_1.docx"])],
)
def test_unzip_file(zip_file: Path, extracted_files: List[str], tmpdir):
    unzip_file(zip_file, Path(tmpdir).resolve())

    for file_name in extracted_files:
        assert os.path.isfile(f"{tmpdir}\\{file_name}")
